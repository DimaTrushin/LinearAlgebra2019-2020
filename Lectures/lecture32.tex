\ProvidesFile{lecture32.tex}[Лекция 32]

\subsection{Классификация движений}

Краткий план классификации следующий: мы сначала классифицируем движения в эрмитовом случае, а потом сведем евклидов случай к эрмитовому с помощью комплексификации. Окажется, что в эрмитовом случае все движения диагонализуются в ортонормированном базисе и на диагонали у них будут комплексные числа по модулю $1$. В евклидовом случае движения будут блочно диагональными, где на диагонали будут стоять $\pm1$ и блоки поворотов.

\begin{claim}\label{claim::HermMoveClassific}
Пусть $V$ -- эрмитово пространство и $\phi\colon V\to V$ -- некоторый оператор. Тогда эквивалентно
\begin{enumerate}
\item $\phi$ является движением (унитарный оператор).
\item Выполнены следующие свойства:
\begin{enumerate}
\item $\phi$ диагонализуем в ортонормированном базисе.
\item Для любого $\lambda\in\spec_\mathbb C\phi$, имеем $|\lambda| = 1$.\footnote{Если через $S^1$ обозначить единичную окружность в $\mathbb C$, то есть комплексные числа равные по модулю $1$, то это условие можно записать как $\spec_\mathbb C\phi \subseteq S^1$.}
\end{enumerate}
\end{enumerate}
\end{claim}
\begin{proof}
(2)$\Rightarrow$(1). Пусть $e_1,\ldots,e_n$ -- тот самый ортонормированный базис и $A$ -- матрица оператора $\phi$. В силу условия~(b) имеем $A^*A = E$. Тогда по утверждению~\ref{claim::MovementMatrix} (описание движений в терминах матриц) $\phi$ является движением.

(1)$\Rightarrow$(2). Так как мы действуем над полем комплексных чисел, то у нас обязательно найдется ненулевой собственный вектор $v\in V$ для некоторого $\lambda\in\spec_\mathbb C\phi$. Тогда $V = \langle v\rangle \oplus \langle v\rangle^\bot$. По утверждению~\ref{claim::MovmentBasicProp} пункт~3, это разложение в прямую сумму $\phi$-инвариантных подпространств. Положим $e_1 = v/|v|$. Так как $\langle v\rangle^\bot$ является $\phi$-инвариантным, то можно применить индукцию для $\phi|_{\langle v \rangle^\bot}$  по размерности пространства и найдем ортонормированный базис $e_2,\ldots,e_n$ в $\langle v\rangle^\bot$, в котором ограничение $\phi$ диагонализуется. Тогда $e_1,\ldots,e_n$ -- ортонормированный базис, в котором диагонализуется $\phi$. На диагонали $\phi$ будут стоять элементы $\spec_\mathbb C\phi$. По утверждению~\ref{claim::MovmentBasicProp} пункт~1 они все по модулю равны $1$, что и требовалось.
\end{proof}

\paragraph{Замечание}
Обратите внимание на интересный момент. Если вы рассмотрите пространство $\mathbb R^2$ со стандартным скалярным произведением, то оператор заданный матрицей
\[
A =
\begin{pmatrix}
{\cos \alpha}&{-\sin\alpha}\\
{\sin \alpha}&{\cos \alpha}
\end{pmatrix}
\]
Является поворотом на угол $\alpha$ и в частности это движение. Если $\alpha$ не кратен $\pi$, то этот оператор не имеет инвариантных подпространств, а значит он не диагонализуем.

С другой стороны, если рассмотреть пространство $\mathbb C^2$ со стандартным скалярным произведением  и оператор заданный той же самой матрицей $A$, то полученный оператор будет движением. Но при этом он диагонализуется в виде
\[
\begin{pmatrix}
{\cos \alpha + i\sin \alpha}&{0}\\
{0}&{\cos \alpha - i\sin \alpha}
\end{pmatrix}
=
\begin{pmatrix}
{e^{i\alpha}}&{0}\\
{0}&{e^{-i\alpha}}
\end{pmatrix}
\]
Таким образом поворот в плоскости сменился на две сопряженные поляризации внутри каждой из комплексных прямых. Это любопытное явление, которое очень сильно контрастирует с вещественной интуицией. Имейте это в виду, когда работаете в комплексном случае.


\begin{claim}
Пусть $V$ -- комплексное векторное пространство и $\phi\colon V\to V$ -- некоторый оператор. Тогда эквивалентно:
\begin{enumerate}
\item Существует скалярное произведение на $V$, относительно которого $\phi$ является движением.
\item Выполнены следующие свойства:
\begin{enumerate}
\item $\phi$ диагонализуем.
\item Для любого $\lambda\in\spec_\mathbb C\phi$, имеем $|\lambda| = 1$.
\end{enumerate}
\end{enumerate}
\end{claim}
\begin{proof}
(1)$\Rightarrow$(2). Если существует скалярное произведение, то оно задает структуру эрмитова пространства, а значит мы можем применить предыдущее утверждение.

(2)$\Rightarrow$(1). Пусть $e_1,\ldots,e_n$ -- базис, в котором $\phi$ диагонализуем. Зададим скалярное произведение так, чтобы $e_1,\ldots,e_n$ был ортонормированным (это делается аналогично утверждению~\ref{claim::ScalarDef}). Тогда выполнен пункт~(2) предыдущего утверждения, а значит и выполнен пункт~(1). То есть $\phi$ является движением относительно построенного скалярного произведения.
\end{proof}


В случае евклидова пространства нам нужно одно техническое наблюдение.

\begin{claim}\label{claim::OrthoRealfix}
Пусть $V$ -- евклидово пространство, $V_\mathbb C$ -- его комплексификация и $w\in V_\mathbb C$. Тогда эквивалентно
\begin{enumerate}
\item $w\bot \bar w$
\item выполнены два условия:
\begin{enumerate}
\item $|\Re w | = |\Im w|$
\item $\Re w \bot \Im w$
\end{enumerate}
\end{enumerate}
\end{claim}
\begin{proof}
Пусть $w = v+ iu$. Тогда, расписав по определению, получим $(w, \bar w) = (v, v) - (u,u) +2i(v,u)$. Значит, 
\[
w\bot \bar w \iff
\left\{
\begin{aligned}
&(v,v) - (u,u) = 0\\
&(v,u) = 0
\end{aligned}
\right.
\iff
\left\{
\begin{aligned}
|v| &= |u|\\
v &\bot u
\end{aligned}
\right.
\]
\end{proof}


\begin{claim}\label{claim::OrthotInvarSub}
Пусть $V$ евклидово пространство и $\phi \colon V\to V$ -- некоторое движение. Тогда
\begin{itemize}
\item Либо существует собственный вектор $v\in V$ для собственных значений $\pm 1$.
\item Либо существует инвариантное двумерное подпространство $U\subseteq V$ и его ортонормированный базис $e_1, e_2$ такие, что матрица $\phi|_U$ в этом базисе имеет вид
\[
\begin{pmatrix}
{\cos \alpha}&{-\sin \alpha}\\
{\sin \alpha}&{\cos \alpha}
\end{pmatrix}
,\;\text{для некоторого $\alpha \in [0,2\pi)$}
\]
\end{itemize}
\end{claim}
\begin{proof}
По утверждению~\ref{claim::MovmentBasicProp} все вещественные собственные значения $\phi$ -- это $\pm 1$. Значит, если спектр не пуст, то выполнено первое условие. Пусть $\spec_\mathbb R= \varnothing$. В этом случае перейдем к комплексификации отображения $\phi_\mathbb C\colon V_\mathbb C\to V_\mathbb C$. По утверждению~\ref{claim::MovementComplfix} $\phi_\mathbb C$ является движением в эрмитовом пространстве. Так как $\mathbb C$ алгебраически замкнуто, то спектр обязательно не пуст. А по утверждению~\ref{claim::MovmentBasicProp} в нем обязательно числа по модулю равные $1$. Значит найдется $\lambda = \cos \alpha - i \sin \alpha$ и $w= v + i u\in V_\mathbb C$ такие, что $\phi_\mathbb C(w) = \lambda w$. Давайте распишем эти условия более явно. С одной стороны по определению:
\[
\phi_\mathbb C(w) = \phi(v) + i\phi(u)
\]
С другой стороны, так как $w$ собственные, имеем
\[
\phi_\mathbb C(w) = \lambda w = (\cos \alpha - i \sin \alpha) (v+ i u) = \cos \alpha \;v + \sin \alpha\; u + (-\sin \alpha\; v +\cos\alpha\; u)
\]
Но в комплексификации вектора равны тогда и только тогда, когда их вещественные и мнимые части равны. Значит,
\begin{align*}
\phi(v) &= \cos \alpha\; v + \sin \alpha\; u\\
\phi(u) &= -\sin \alpha\; v +\cos\alpha\; u
\end{align*}
Таким образом подпространство в $V$ натянутое на векторы $v$ и $u$ является $\phi$ инвариантым. Если я теперь покажу, что векторы $v$ и $u$ ортогональны и имеют одинаковую длину, то пространство $\langle v,u\rangle$ будет двумерным и, поделив их на их общую длину, я получу ортонормированный базис и матрица оператора в этом базисе будет ровно такой, как и заявлено.

Давайте применим комплексное сопряжение к равенству $\phi_\mathbb C(w) = \lambda w$. Тогда левая часть
\[
\overline{\phi_\mathbb C(w)} = \overline{\phi(v) + i \phi(w)} = \phi(v) - i \phi(w) = \phi_\mathbb C(v - iu) = \phi_\mathbb C(\overline{v + i w}) = \phi_\mathbb C(\bar w)
\]
А правая часть равно
\[
\overline{\lambda w} = \bar \lambda \bar w
\]
То есть $\bar w$ -- это собственный вектор с собственным значением $\bar \lambda$. Но так как $\lambda$ было не вещественным числом, $\lambda \neq \bar\lambda$. А значит, по утверждению~\ref{claim::MovmentBasicProp} векторы $w$ и $\bar w$ ортогональны. Но тогда по утверждению~\ref{claim::OrthoRealfix} $|v| = |u|$ и $(v, u) = 0$. При этом длина этих векторов не ноль, иначе $w$ был бы нулем, что противоречило бы его выбору.

\end{proof}

\begin{claim}
Пусть $V$ евклидово пространство и $\phi\colon V\to V$ -- некоторый оператор. Тогда эквивалентно
\begin{enumerate}
\item $\phi$ является движением (ортогональный оператор).
\item В некотором ортонормированном базисе матрица оператора $\phi$ имеет вид:
\[
A_\phi=
\begin{pmatrix}
{A_1}&{}&{}\\
{}&{\ddots}&{}\\
{}&{}&{A_r}\\
\end{pmatrix},
\quad\text{где}\quad
A_i\;\;\text{либо}\;\;1,\;\;\text{либо}\;\;-1,\;\;\text{либо}\;\;
\begin{pmatrix}
{\cos \alpha}&{-\sin\alpha}\\
{\sin\alpha}&{\cos\alpha}
\end{pmatrix}
\]
\end{enumerate}
\end{claim}
\begin{proof}
(2)$\Rightarrow$(1). Пусть $e_1,\ldots,e_n$ -- тот самый ортонормированный базис и $A$ -- матрица оператора $\phi$. Прямая проверка показывает, что $A^tA = E$. Тогда по утверждению~\ref{claim::MovementMatrix} (описание движений в терминах матриц) $\phi$ является движением.


(1)$\Rightarrow$(2). По утверждению~\ref{claim::OrthotInvarSub} возможен один из двух случаев:
\begin{enumerate}
\item Существует собственный вектор $v$ с собственным значением $1$ или $-1$.
\item Существует инвариантное двумерное подпространство $U$ с ортонормированным базисом $e_1, e_2$ такие, что матрица $\phi|U$ в этом базисе имеет указанный вид.
\end{enumerate}

Если у нас случай (1), то мы рассмотрим разложение пространства $V = \langle v\rangle \oplus \langle v\rangle^\bot$. Тогда ортогональное дополнение будет $\phi$-инвариантным. Значит мы можем ограничить на него $\phi$, по индукции там найти ортонормированный базис $e_2,\ldots,e_n$ с требуемыми свойствами. Тогда положим $e_1 = v / |v|$ и базис $e_1,\ldots,e_n$ будет искомым.

Если у нас случай (2), то мы рассмотрим разложение $V = U \oplus U^\bot$. Тогда ортогональное дополнение будет $\phi$-инвариантным. Значит мы можем ограничить на него $\phi$ и как и раньше найти ортонормированный базис $e_3,\ldots,e_n$ с требуемыми свойствами. Тогда возьмем $e_1,e_2$ из $U$ и базис $e_1,\ldots,e_n$ будет искомым.
\end{proof}


\begin{claim}
Пусть $V$ -- вещественное векторное пространство и $\phi\colon V\to V$ -- некоторый оператор. Тогда эквивалентно:
\begin{enumerate}
\item Существует скалярное произведение на $V$, относительно которого $\phi$ является движением.
\item В некотором базисе матрица оператора $\phi$ имеет вид:
\[
A_\phi=
\begin{pmatrix}
{A_1}&{}&{}\\
{}&{\ddots}&{}\\
{}&{}&{A_r}\\
\end{pmatrix},
\quad\text{где}\quad
A_i\;\;\text{либо}\;\;1,\;\;\text{либо}\;\;-1,\;\;\text{либо}\;\;
\begin{pmatrix}
{\cos \alpha}&{-\sin\alpha}\\
{\sin\alpha}&{\cos\alpha}
\end{pmatrix}
\]
\end{enumerate}
\end{claim}
\begin{proof}
(1)$\Rightarrow$(2). Если существует скалярное произведение, то оно задает структуру евклидова пространства, а значит мы можем применить предыдущее утверждение.

(2)$\Rightarrow$(1). Пусть $e_1,\ldots,e_n$ -- базис, в котором $\phi$ имеет указанный блочный вид. Зададим скалярное произведение так, чтобы $e_1,\ldots,e_n$ был ортонормированным (так сделать можно по утверждению~\ref{claim::ScalarDef}). Тогда выполнен пункт~(2) предыдущего утверждения, а значит и выполнен пункт~(1). То есть $\phi$ является движением относительно построенного скалярного произведения.
\end{proof}

% TO DO 
% Движения в двух мерном и трехмерном пространствах!

\subsection{Сопряженное линейное отображение}

В случае произвольного линейного оператора $\phi$ на пространстве $V$, его сопряженный или двойственный $\phi^*$ живет на $V^*$ и это неудобно. В случае евклидова или эрмитова пространства можно определить сопряженный оператор уже на самом пространстве $V$. Я в начале расскажу, как строится подобный оператор на пространстве $V$ с помощью скалярного произведения, а потом уже поясню, как он связан с нашим старым знакомым на двойственном пространстве.

\begin{claim}
Пусть $V$ и $U$ -- евклидовы или эрмитовы пространства и $\phi\colon V\to U$ линейное отображение. Тогда существует единственное линейное отображение $\phi^*\colon U\to V$ такое, что $(\phi v, u) = (v, \phi^* u)$ для любых $v\in V$ и $u\in U$.
\end{claim}
\begin{proof}
Для доказательства перейдем в базисы и сделаем все на матричном языке. Давайте я для определенности рассмотрю эрмитов случай. Пусть $e_1,\ldots,e_n$ ортонормированный базис пространства $V$, а $f_1,\ldots,f_m$ -- ортонормированный базис пространства $U$. Тогда $V$ превращается в $\mathbb C^n$, $U$ превращается в $\mathbb C^m$, скалярное произведение в обоих пространствах становится стандартным, а отображение $\phi$ превращается в отображение $\mathbb C^n \to \mathbb C^m$ по правилу $x \mapsto Ax$ для некоторой $A\in\operatorname{M}_{m\,n}(\mathbb C)$. Давайте будем искать наше отображение $\phi^*$  в виде $\phi^*(x) = Bx$, где $B\in \operatorname{M}_{n\,m}(\mathbb C)$ и покажем, что существует ровно одно линейное отображение удовлетворяющее нужным условиям.

Действительно, условие $(\phi v, u) = (v, \phi^* u)$ переписывается так
\[
(\overline{Ax})^t y = \bar x^t By\iff \bar x^t \bar A^t y = \bar x^t B y
\]
И это должно выполняться для любых $x\in \mathbb C^n$ и $y\in \mathbb C^m$. А это возможно тогда и только тогда, когда $B = \bar A^t$. Что и означает, что нужное отображение найдется и единственное.
\end{proof}

\begin{definition}
Если $V$ и $U$ -- евклидовы или эрмитовы пространства и $\phi\colon V\to U$ -- линейное отображение. Тогда отображение $\phi^*\colon U\to V$ называется сопряженным к $\phi$. В частности, если $\varphi\colon V\to V$ является линейным оператором, то $\varphi^*$ называется сопряженным оператором.\footnote{Иногда говорят евклидово сопряженный или эрмитово сопряженный, чтобы подчеркнуть, что мы в евклидовом или эрмитовом случае.}
\end{definition}

\paragraph{Замечания}
\begin{itemize}
\item В силу симметричности скалярного произведения определение сопряженного отображения можно дать в виде $(\phi^* u, v) = (u, \phi v)$. Таким образом по простому, сопряженное линейное отображение  -- это такое линейное отображение, которое получается при перекидывании внутри скалярного произведения. Это означает, что если вы хотите что-то доказать для сопряженного линейного отображения, то надо желаемый факт выразить в терминах скалярного произведения, а после этого перекинуть $\phi^*$ и превратить его в $\phi$ и воспользоваться свойствами $\phi$ или наоборот.

\item Обратите внимание, что если у нас оператор $\phi\colon V\to V$ в ортонормированном базисе задан матрицей $A$, то оператор $\phi^*$ в этом же базисе будет задан матрицей $A^t$ в вещественном случае и $A^* = \bar A^t$ в комплексном случае. 

\item Пусть теперь $\phi\colon V\to U$ -- произвольное линейное отображение. Пусть $e_1,\ldots,e_n$ -- некоторый базис в $V$ и $f_1,\ldots, f_m$ -- некоторый базис в $U$. Пусть скалярное произведение $V$ в указанном базисе задано матрицей $B$, а в пространстве $U$ в указанном базисе задано матрицей $G$. Тогда если $\phi$ задан матрицей $A$, то матрица сопряженного линейного отображения будет $B^{-1} A^t G$ в вещественном случае и $B^{-1}\bar A^t G$ в комплексном.

\item Если $\phi\colon V\to V$ движение, то это значит, что $(\phi v, \phi u) = (v, u)$. Если обозначить $\phi u $ за $w$, то получим, что $\phi$ движение, тогда и только тогда, когда $(\phi v, w) = (v, \phi^{-1}w)$ для любых $v,w\in V$. То есть $\phi$ движение, тогда и только тогда, когда $\phi^* = \phi^{-1}$. Таким образом движения можно выразить в терминах сопряженного оператора.

\item В общем случае даже не пытайтесь понять геометрический смысл сопряженного оператора. Это совсем не очевидная штука.
\end{itemize}

\paragraph{Связь с двойственным пространством}

Здесь мне придется разобрать отдельно евклидов и эрмитов случай. Пусть $V$ и $U$ -- евклидовы пространства и $\phi\colon V\to U$ -- линейное отображение. Тогда существует двойственное линейное отображение $\phi^*\colon U^*\to V^*$ по правилу $\xi \mapsto \xi \phi$. Кроме этого, скалярное произведение индуцирует изоморфизм $V\to V^*$ по правилу $v\mapsto ({-},v)$ и  аналогично для $U$. В итоге получаем следующую диаграмму
\[
\xymatrix{
	{V^*}&{U^*}\ar[l]_{\phi^*}\\
	{V}\ar@{~>}[u]&{U}\ar@{~>}[u]\ar@{-->}[l]_{\psi}
}
\quad
\xymatrix{
	{({-},\psi u) = (\phi({-}), u)}&{({-}, u)}\ar@{|->}[l]\\
	{\psi u}\ar@{|->}[u]&{u}\ar@{|->}[u]\ar@{|->}[l]
}
\]
Вертикальные стрелки -- это изоморфизмы с помощью скалярного произведения, а нижняя пунктирная стрелка -- это композиция: сначала изоморфизм $U\to U^*$, потом $\phi^*$, потом обратный изоморфизм $V^* \to V$. Давайте посмотрим, что получается в качестве отображения $\psi$. Для этого возьмем произвольный вектор $u\in U$ и пройдем двумя путями в $V^*$. Справа показан расчет результатов. Получаем, что функции $({-},\psi u)$ и $(\phi({-}), u)$ на $V$ совпадают при любых $u\in U$, то есть для любого $v\in V$ и любого $u\in U$ имеем равенство $(v, \psi u) = (\phi v, u)$. Теперь мы видим, что $\psi$ совпадает с определением сопряженного линейного отображения $\phi^*\colon U\to V$ .


Теперь давайте разберемся с комплексным случаем. Ситуация здесь похожая, но появляется одна тонкость. Но обо всем по порядку. Пусть $V$ и $U$ -- эрмитовы пространства и $\phi\colon V\to U$ -- линейное отображение. Однако, в этом случае отображение $V\to V^*$ по правилу $v\mapsto (v, {-})$ не является $\mathbb C$-линейным, а отображение $v\mapsto ({-}, v)$ не корректно, потому что результат не является $\mathbb C$-линейной функцией на $V$. Это правится переходом к пространствам $\bar V$ и $\bar U$. А именно, отображение $\phi\colon V\to U$ определяет отображение $\bar \phi\colon \bar V\to \bar U$ по правилу $v\mapsto \phi(v)$, то есть мы действуем так же, как и исходное отображение $\phi$. Кроме этого отображение $V\to \bar V^*$ по правилу $({-}, v)$ является $\mathbb C$-линейным изоморфизмом. Теперь имеем следующую диаграмму в комплексном случае
\[
\xymatrix{
	{\bar V^*}&{\bar U^*}\ar[l]_{\bar \phi^*}\\
	{V}\ar@{~>}[u]&{U}\ar@{~>}[u]\ar@{-->}[l]_{\psi}
}
\quad
\xymatrix{
	{({-},\psi u) = (\phi({-}), u)}&{({-}, u)}\ar@{|->}[l]\\
	{\psi u}\ar@{|->}[u]&{u}\ar@{|->}[u]\ar@{|->}[l]
}
\]
И как и в вещественном случае раскручивание определений приводит нас к равенству $(v, \psi u) = (\phi v, u)$ для всех $v\in V$ и $u\in U$, что означает, что $\psi$ совпадает с определением сопряженного оператора.

\subsection{Самосопряженные операторы}

Мы уже видели пример операторов согласованных со скалярными произведениями -- движения. Сейчас я познакомлю вас с еще одним классом операторов.

\begin{definition}
Пусть $V$ евклидово или эрмитово пространство. Тогда оператор $\phi$ называется самосопряженным, если $\phi = \phi^*$. В евклидовом пространстве самосопряженные операторы обычно называются симметричными.
\end{definition}

\paragraph{Замечания}
\begin{itemize}
\item Если $e_1,\ldots,e_n$ -- ортонормированный базис в пространстве $V$ и оператор $\phi$ в этом базисе задан матрицей $A$, то $\phi^*$ задан матрицей $A^t$ в евклидовом случае и $\bar A^t$ в комплексном. Потому оператор $\phi$ самосопряжен тогда и только тогда, когда $A = A^t$ в евклидовом случае и $A = \bar A^t$ в комплексном случае.

\item Если $\phi\colon V\to V$ -- некоторый оператор в евклидовом пространстве и $\phi_\mathbb C\colon V_\mathbb C\to V_\mathbb C$ -- его комплексификация. Тогда оператор $\phi$ самосопряжен тогда и только тогда, когда $\phi_\mathbb C$ самосопряжен. Легче всего это проверить так: выберем ортонормированный базис $e_1,\ldots,e_n$ в пространстве $V$, тогда он будет ортонормированным в пространстве $V_\mathbb C$. Если оператор $\phi$ в этом базисе задан матрицей $A\in \Matrix{n}$, то оператор $\phi_\mathbb C$ задан той же матрицей в этом же базисе. Но тогда условие $A = A^t$ равносильно $A = \bar A^t$. Первое из них означает самосопряженность $\phi$, а второе самосопряженность $\phi_\mathbb C$.

\item Давайте я тут нагоню немного мистики. Оказывается, что самосопряженные операторы являются моделью измеряемых величин в квантовой физике. Их спектры отвечают возможным значениям от измерений. Кроме того, с помощью скалярного произведения можно ввести вероятностную меру на спектре, что превращает наши измерения в случайные. Тот факт, что два оператора коммутируют означает, что эти измерения можно проделать одновременно. А если операторы не коммутируют, то значит эти измерения одновременно не производятся. Главный пример из квантовой механики -- координата и импульс. Измеряя все точнее координату, мы теряем точность измерения импульса и наоборот. Все эти странные вещи можно объяснить с помощью самосопряженных операторов на некотором гильбертовом пространстве (это полные бесконечномерные евклидовы пространства). Чтобы в полной мере изучать такие вещи, приходится изучать правильную бесконечномерную линейную алгебру. Имя ей -- функциональный анализ. Хотите заниматься квантовой криптографией или квантовыми вычислениями? Знайте, такое безобразие тоже существует и эти вещи ближе, чем они кажутся. Главное -- выучить линейную алгебру как следует.
\end{itemize}

\begin{claim}\label{claim::SelfAdjBasicProp}
Пусть $V$ -- евклидово или эрмитово пространство и $\phi\colon V\to V$ -- самосопряженный оператор, тогда
\begin{enumerate}
\item В вещественном случае: $\spec_\mathbb R \phi\neq \varnothing$. В комплексном случае: $\spec_\mathbb C\phi \subseteq \mathbb R$.
\item Если $\lambda\neq\mu$ -- два разных собственных значения для $\phi$, то подпространства $V_\lambda$ и $V_\mu$ ортогональные.
\item Если $U\subseteq V$ $\phi$-инвариантное подпространство, то $U^\bot$ тоже $\phi$-инвариантное подпространство.
\end{enumerate}
\end{claim}
\begin{proof}
1) Давайте в начале рассмотрим комплексный случай. Пусть $\lambda\in \spec_\mathbb C\phi$. Тогда для найдется ненулевой вектор $v\in V$ такой, что $\phi v = \lambda v$. Посчитаем выражение $(\phi v, v)$ двумя способами. С одной стороны
\[
(\phi v, v) = (\lambda v, v) = \bar \lambda (v, v)
\]
С другой стороны
\[
(\phi v, v) = (v, \phi^* v) = (v,\phi v) = (v,\lambda v) = \lambda (v, v)
\]
То есть $\bar\lambda (v, v) = \lambda (v,v)$. Так как $v$ ненулевой, то $(v,v)\neq0$. А это значит, что $\bar\lambda = \lambda$, то есть $\lambda \in \mathbb R$.

Теперь рассмотрим вещественный случай. Пусть $\phi\colon V\to V$ наш самосопряженный оператор. Рассмотрим его комплексификацию $\phi_\mathbb C\colon V\to V$. Это самосопряженный оператор в эрмитовом пространстве. По уже доказанному его спектр вещественный. Но $\phi$ и $\phi_\mathbb C$ имеют одинаковые матрицы, значит их спектры совпадают. В частности $\spec_\mathbb R \phi = \spec_\mathbb C\phi_\mathbb C\neq \varnothing$.

2) Пусть теперь $v\in V_\lambda$ и $u\in V_\mu$. Тогда
\[
(\phi v, u) = (\lambda v, u) = \bar \lambda (v,u) = \lambda (v, u)
\]
Здесь мы воспользовались тем, что все собственные значения вещественные. Теперь посчитаем по-другому
\[
(\phi v, u) = (v,\phi^* u) = (v, \phi u) = (v, \mu u) = \mu (v, u)
\]
То есть $\lambda (v, u) = \mu (v,u)$. Но при этом $\lambda \neq \mu$. Значит $(v, u) = 0$.

3) Нам надо показать, что если $w\bot U$, то $\phi(w)\bot U$. Имеем $(\phi w, u) = (w, \phi^* u) = (w, \phi u)$ для любого $u\in U$ и $w\in U^\bot$. В силу $\phi(U) \subseteq U$ получаем, что $\phi u \in U$. То есть $(\phi w, u) = (w, \phi u) = 0$ для любого $u\in U$, что и требовалось.
\end{proof}
